#!/bin/bash
# Script Name: summaryData-0x03
# Description: Extracts name, height, and weight from PokÃ©mon JSON files
#              Generates a CSV report and computes averages.

# Output CSV file
output_file="pokemon_report.csv"

# Check if JSON files exist
json_files=$(ls *.json 2>/dev/null)
if [ -z "$json_files" ]; then
    echo "No JSON files found in the current directory!"
    exit 1
fi

# Create the CSV header
echo "Name,Height (m),Weight (kg)" > "$output_file"

# Extract name, height, and weight from each JSON file
for file in $json_files; do
    name=$(jq -r '.name' "$file")
    height=$(jq -r '.height' "$file")
    weight=$(jq -r '.weight' "$file")
    echo "$name,$height,$weight" >> "$output_file"
done

echo "CSV Report generated at: $output_file"
echo

# Display the content
cat "$output_file"
echo

# Calculate average height and weight using awk
awk -F',' '
NR>1 {
    total_height += $2;
    total_weight += $3;
    count++;
}
END {
    avg_height = total_height / count;
    avg_weight = total_weight / count;
    printf "\nAverage Height: %.2f m\nAverage Weight: %.2f kg\n", avg_height, avg_weight;
}' "$output_file"
